@use "xmlui/themes.scss" as t;

// --- This code snippet is required to collect the theme variables used in this module
$themeVars: ();
@function createThemeVar($componentVariable) {
  $themeVars: t.appendThemeVar($themeVars, $componentVariable) !global;
  @return t.getThemeVar($themeVars, $componentVariable);
}

$componentInput: "SearchInput";
$componentContainer: "SearchContainer";
$themeVars: t.composePaddingVars($themeVars, $componentContainer);
$themeVars: t.composePaddingVars($themeVars, $componentInput);
$textColor-SearchInput: createThemeVar("textColor-#{$componentInput}");
$fontFamily-SearchInput: createThemeVar("fontFamily-#{$componentInput}");
$width-SearchInput: createThemeVar("width-#{$componentInput}");
$height-SearchInput: createThemeVar("height-#{$componentInput}");
$fontSize-SearchInput: createThemeVar("fontSize-#{$componentInput}");
$fontWeight-SearchInput: createThemeVar("fontWeight-#{$componentInput}");
$borderColor-SearchInput: createThemeVar("borderColor-#{$componentInput}");
$textColor-placeholder-SearchInput: createThemeVar("textColor-placeholder-#{$componentInput}");
$backgroundColor-SearchInput: createThemeVar("backgroundColor-#{$componentInput}");
$backgroundColor-SearchInput--active: createThemeVar("backgroundColor-#{$componentInput}--active");
$textColor-adornment-SearchInput: createThemeVar("textColor-adornment-#{$componentInput}");
$textColor-adornment-SearchInput--active: createThemeVar("textColor-adornment-#{$componentInput}--active");

$componentListPanel: "SearchPanel";
$themeVars: t.composeBorderVars($themeVars, $componentListPanel);
$themeVars: t.composePaddingVars($themeVars, $componentListPanel);
$backgroundColor-Search: createThemeVar("backgroundColor-#{$componentListPanel}");
$boxShadow-Search: createThemeVar("boxShadow-#{$componentListPanel}");

$componentListItem: "SearchItem";
$borderRadius-SearchItem: createThemeVar("borderRadius-#{$componentListItem}");
$backgroundColor-SearchItem--hover: createThemeVar("backgroundColor-#{$componentListItem}--hover");
$borderColor-SearchItem--focus: createThemeVar("borderColor-#{$componentListItem}--focus");

// Keyframe animations for collapsible search
@keyframes expandSearch {
  from {
    transform: scaleX(0);
    opacity: 0;
  }
  to {
    transform: scaleX(1);
    opacity: 1;
  }
}

@keyframes collapseSearch {
  from {
    transform: scaleX(1);
    opacity: 1;
  }
  to {
    transform: scaleX(0);
    opacity: 0;
  }
}

.listPanel {
  @include t.borderVars($themeVars, $componentListPanel);
  @include t.paddingVars($themeVars, $componentListPanel);
  overflow: hidden;
  width: 580px;
  margin-top: 4px;
  box-shadow: $boxShadow-Search;

  &.inDrawer {
    width: var(--radix-popover-trigger-width);
    z-index: 1;
  }
}

.list {
  background-color: $backgroundColor-Search;
  max-height: 360px;
  overflow-y: auto;
  scrollbar-gutter: stable;
  scrollbar-width: thin;
  padding: 0.75rem;
}

.input {
  color: $textColor-SearchInput;
  font-family: $fontFamily-SearchInput;
  width: $width-SearchInput;
  height: $height-SearchInput;
  font-size: $fontSize-SearchInput;
  font-weight: $fontWeight-SearchInput;
  background-color: $backgroundColor-SearchInput;
  border-color: $borderColor-SearchInput;
  @include t.paddingVars($themeVars, $componentInput);


  &.active {
    [data-part-id="startAdornment"],
    [data-part-id="endAdornment"] {
      color: $textColor-adornment-SearchInput--active;
    }
  }

  &.focused {
    background-color: $backgroundColor-SearchInput--active;
  }

  &.fullWidth {
    width: 100%;
  }

  &.expanding {
    transform-origin: right center;
    animation: expandSearch 0.3s ease-out forwards;
  }

  &.collapsing {
    transform-origin: right center;
    animation: collapseSearch 0.3s ease-in forwards;
  }

  & > input::placeholder {
    color: $textColor-placeholder-SearchInput;
  }

  [data-part-id="startAdornment"],
  [data-part-id="endAdornment"] {
    color: $textColor-adornment-SearchInput;
  }
}

.noResults {
  display: flex;
  justify-content: center;
  align-items: center;
}

.item {
  list-style: none;
  padding-top: 0.4rem;
  padding-bottom: 0.4rem;
  padding-inline: 0.75rem;
  border-radius: $borderRadius-SearchItem;
  border: 2px solid transparent;
  cursor: pointer;
  
  // This style is used to denote keyboard focus
  &.keyboardFocus {
    background-color: $backgroundColor-SearchItem--hover;
    
    // Ensures the underlying link is visible on programmatic hover
    & > a {
      color: var(--xmlui-textColor-primary);
    }
  }

  & > a {
    color: var(--xmlui-textColor-primary);

    &:hover {
      color: inherit;
    }
    &:active {
      color: var(--xmlui-textColor-primary);
    }
  }

  & > a .snippet {
    padding-top: 0.25rem;
    padding-bottom: 0.25rem;
  }

  &.header:has(+ .content):not(:first-child) {
    margin-top: 0.5rem;
  }
}

:export{
  themeVars: t.json-stringify($themeVars)
}
