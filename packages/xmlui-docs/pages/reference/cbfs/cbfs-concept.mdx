# CBFS Concepts

## Supposed CBFS Conceptual Model

By the XMLUI Team's understanding, the current CBFS domain model is something like the following:

![Supposed Model](/resources/draft/supposed-cbfs.svg)

- `Principal`: The currently authenticated user, if there is any. Authenticated users may come from a user directory with groups and memberships.
- `FSEntry`: a file or folder entry, the hierarchy representing a file system (store). File system entries may have permissions for users.
- `Share`: An `FSEntry` may be shared with users (`Principal`) with a particular set of `SharePermission` instances.

 **Note**: The current concept of shares merges anonymous access and private access of shares. Though technically, they are "shares", their roles and how we manage them differ.

## Suggested Conceptual Model

We suggest separate `Shares` into two different entities:
- `AnonymShare`: A share that can be accessed through a public URL with "view only" or "edit" access.
- `PrivateShare`: A share with explicitly set permissions, available only by authenticated users.

![Suggested Model](/resources/draft/cbfs-concept.svg)

## Questions

We need to determine the available operations of a particular file or folder using these pieces of information:
- The hierarchy of files and folders
- The direct and indirect group membership of the logged-in user
- Permissions assigned to an individual file or folder versus the permissions assigned through shares

**Q1**: Do we have only grants as permissions, or can we remove permissions granted?

**A1**: ???

**Q2**: How do we merge a user's permissions with the permissions of the groups in which the user is directly or indirectly a member?

**A3**: ???

**Q3**: How do we calculate the permissions of a particular file or folder using the permissions assigned to the parent folder (including multiple depths)?

**A3**: ???

**Q4**: How do we merge the permissions of a particular file calculated from the hierarchy of file permissions with share permissions?

**A4**: ???

**Q5**: How do we handle files and folders available through multiple shares?

**A5**: ???

**Q6**: Do we allow renaming shared files? What if they are shared directly or through a folder?

**A6**: ???

**Q7**: Do we allow moving shared files? What if they are shared directly or through a folder?

**A7**: ???

**Q8**: Do we allow copying shared files? What if they are shared directly or through a folder?

**A8**: ???

**Q9**: Do we allow deleting shared files? What if they are shared directly or through a folder?

**A9**: ???
